<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register Your Hotel</title>
    <link rel="stylesheet" href="AdminSide.css">
</head>
<body>
    <div class="form-container">
        <h1>Register Your Hotel</h1>
        <form id="hotelForm" enctype="multipart/form-data">
            <input type="text" class="form-input" name="name" placeholder="Hotel Name" required>
            <textarea class="form-input" name="description" placeholder="Hotel Location" id="locationInput" required></textarea>
            <p id="charCount">Characters: 0/20</p>
            <input type="file" class="form-input" name="image" accept="image/*" required>

            <div>
                <label>Featured:</label>
                <input type="radio" name="isFeatured" value="true"> Yes
                <input type="radio" name="isFeatured" value="false" checked> No
            </div>

            <div>
                <label>Active:</label>
                <input type="radio" name="isActive" value="true" checked> Yes
                <input type="radio" name="isActive" value="false"> No
            </div>
            <br /><br />
            <button type="submit" id="Signup-button">Register Hotel</button>
        </form>

        <div id="message-container">
        </div>

        <p>Already have an account? <a href="Sign In.html">Sign In</a></p>
        <p><a href="../Sign/Sign.html">Join as: </a></p>
    </div>
    <script>
        // Select the location input field and character count display
        const locationInput = document.getElementById('locationInput');
        const charCount = document.getElementById('charCount');
        const maxLength = 20;
        const messageContainer = document.getElementById('message-container');
        const hotelForm = document.getElementById('hotelForm');

        locationInput.addEventListener('input', function () {
            let currentLength = this.value.length;
            charCount.textContent = `Characters: ${currentLength}/${maxLength}`;
            if (currentLength > maxLength) {
                this.value = this.value.slice(0, maxLength);
                charCount.textContent = `Characters: ${maxLength}/${maxLength}`;
            }
        });

        // Hotel Registration Form Submission
        hotelForm.addEventListener('submit', async function (event) {
            event.preventDefault();

            const formData = new FormData(this);
            

            try {
                const token = localStorage.getItem('token');
                if (!token) {
                    displayMessage('error', 'Authentication token not found. Please sign in again.');
                    return;
                }

                const response = await fetch('http://localhost:5056/api/AddHotel/AddHotel', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}` // Include the JWT token
                    },
                    body: formData
                });

                if (response.ok) {
                    const data = await response.json();
                    console.log('Success:', data);
                    displayMessage('success', 'Hotel registered successfully!');
                    hotelForm.reset();

                } else {
                    const error = await response.json();
                    console.error('Error:', error);
                    displayMessage('error', `Hotel registration failed: ${error.message || response.statusText}`);
                }
            } catch (error) {
                console.error('Error:', error);
                displayMessage('error', 'An error occurred while registering the hotel.');
            }
        });

        function displayMessage(type, message) {
            messageContainer.innerHTML = ''; // Clear previous messages
            const messageDiv = document.createElement('div');
            messageDiv.textContent = message;
            if (type === 'success') {
                messageDiv.className = 'success-message';
            } else if (type === 'error') {
                messageDiv.className = 'error-message';
            }
            messageContainer.appendChild(messageDiv);
        }
    </script>

</body>
</html>